/*
 * 
 * 
 * 
 */
#define cbtn digitalRead(btns[0])
#define rbtn digitalRead(btns[1])

#include <LiquidCrystal.h>

LiquidCrystal lcd(12, 11, 5, 4, 3, 2);
unsigned long  btns[] = {7,8}, stime, elapse;
float eTimes[9],av ;
char phrase[] = "Press yellow button 10 times";
byte count, size = (sizeof(eTimes)/sizeof(unsigned long)) + 1;
bool pressed, last;


void setup() 
{
 
  lcd.begin(16, 2);
   for(byte i =0; i < sizeof(btns); i++)
   {
     pinMode(btns[i], INPUT);
   }
  
}

void loop() {
 pressed = (cbtn == 0); 

//Attach interrupts and do this with a delay that switchs the start to get average times

  
  while(cbtn == 1 && count == 0)
  {
    scroll();
  }
  
  if (pressed == HIGH && last == LOW && count <= size  )
  {
    stime = millis();
    last = pressed;
    delay(5);
    count++;
    lcd.home();
    lcd.print(count);
  }
  else if (pressed == LOW && last == HIGH && count <= size )
  {
    elapse =  millis() - stime;
    eTimes[(count-1)] = elapse;
    last = pressed; 
  }
  last = pressed;

  if(count == 11)
  {  
    for(byte i = 0; i < size-1 ; i++)
      {
      av += (eTimes[i]/100.0);
      }
    
      lcd.clear();
      lcd.println((av/10),5);
      count++;
  }
  
 while (rbtn == 0)
    {
     reset();
    }
   
        
}

/*
 *
 */
void scroll()
{
  lcd.print(phrase);
  delay(1500);

   for(byte i = 0; i < sizeof(phrase)*10; i++)
    {
      if(cbtn == 0)
          {
            lcd.clear();
            return;
          }
     lcd.scrollDisplayLeft();  
     delay(150);
    }

  lcd.clear();
  delay(500);
}

void reset()
  {
  lcd.clear();
  lcd.print("reset");
  delay(1500);
    lcd.clear();
    scroll();
  count = 0;
  

  }  
  
